<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Budget Planner | SilenVault</title>
    <meta name="description" content="Free local-first project budget planner. Track expenses, estimate costs, and save your data securely in your browser.">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="../assets/js/layout.js" defer></script>
    
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #020617; color: #e2e8f0; }
        .glass-panel { background: rgba(15, 23, 42, 0.6); backdrop-filter: blur(12px); border: 1px solid rgba(51, 65, 85, 0.5); }
        .input-dark { background: #0f172a; border: 1px solid #1e293b; color: white; border-radius: 0.5rem; transition: all 0.2s; }
        .input-dark:focus { border-color: #3b82f6; outline: none; box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2); }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #020617; }
        ::-webkit-scrollbar-thumb { background: #1e293b; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #334155; }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <sv-header base-path=".."></sv-header>

    <main class="flex-1 max-w-7xl mx-auto w-full px-4 py-12 flex flex-col lg:flex-row gap-8">
        
        <div class="flex-1 space-y-6">
            <div class="text-center mb-8">
                <h1 class="text-3xl md:text-5xl font-bold text-white mb-4 tracking-tight">
                    Budget <span class="text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-indigo-400">Architect</span>
                </h1>
                <p class="text-slate-400 max-w-lg mx-auto">
                    Plan your next project with zero data leaks. Data is saved automatically to your device.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="glass-panel p-6 rounded-2xl border-blue-500/20">
                    <span class="text-xs font-bold text-slate-500 uppercase tracking-wider">Total Budget</span>
                    <div id="totalBudget" class="text-2xl font-mono font-bold text-white mt-1">₹0.00</div>
                </div>
                <div class="glass-panel p-6 rounded-2xl border-emerald-500/20">
                    <span class="text-xs font-bold text-slate-500 uppercase tracking-wider">Remaining</span>
                    <div id="remainingBudget" class="text-2xl font-mono font-bold text-emerald-400 mt-1">₹0.00</div>
                </div>
                <div class="glass-panel p-6 rounded-2xl border-red-500/20">
                    <span class="text-xs font-bold text-slate-500 uppercase tracking-wider">Spent</span>
                    <div id="totalSpent" class="text-2xl font-mono font-bold text-red-400 mt-1">₹0.00</div>
                </div>
            </div>

            <div class="glass-panel p-6 rounded-2xl flex flex-wrap gap-4 items-end">
                <div class="flex-1 min-w-[200px]">
                    <label class="block text-xs font-bold text-slate-500 uppercase mb-2 ml-1">Overall Project Limit</label>
                    <input type="number" id="projectLimit" value="50000" oninput="updateCalculations()" class="w-full input-dark px-4 py-3 font-mono">
                </div>
                <button onclick="addItem()" class="bg-blue-600 hover:bg-blue-500 text-white font-bold px-6 py-3 rounded-xl transition-all shadow-lg shadow-blue-500/20 flex items-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="2" d="M12 4v16m8-8H4"/></svg>
                    Add Expense
                </button>
                <button onclick="clearAll()" class="px-6 py-3 rounded-xl border border-slate-700 text-slate-400 hover:text-white hover:bg-red-900/20 transition-all font-bold text-sm">
                    Clear All
                </button>
            </div>

            <div class="glass-panel rounded-2xl overflow-hidden">
                <table class="w-full text-left border-collapse">
                    <thead class="bg-slate-900/50 text-slate-500 uppercase text-[10px] font-bold tracking-widest">
                        <tr>
                            <th class="px-6 py-4">Item / Description</th>
                            <th class="px-6 py-4">Category</th>
                            <th class="px-6 py-4 text-right">Cost (₹)</th>
                            <th class="px-6 py-4 w-16"></th>
                        </tr>
                    </thead>
                    <tbody id="expenseList" class="divide-y divide-slate-800">
                        </tbody>
                </table>
            </div>

            <div class="smart-ad-unit w-full text-center overflow-hidden transition-all duration-500">
                <ins class="adsbygoogle"
                     style="display:block"
                     data-ad-client="ca-pub-5449371042798610"
                     data-ad-slot="7594122081"
                     data-ad-format="auto"
                     data-full-width-responsive="true"></ins>
                <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
            </div>
        </div>

        <aside class="w-full lg:w-80 flex flex-col gap-6 shrink-0">
            <div class="glass-panel p-6 rounded-2xl">
                <h3 class="font-bold text-white mb-4 uppercase tracking-wider text-xs">Security Note</h3>
                <p class="text-xs text-slate-400 leading-relaxed">
                    SilenVault uses <strong>WebStorage API</strong>. Your data is stored locally in your browser's secure sandbox. We never see your financial figures.
                </p>
            </div>

            <div class="smart-ad-unit w-full text-center overflow-hidden transition-all duration-500 sticky top-24">
                <ins class="adsbygoogle"
                     style="display:block"
                     data-ad-client="ca-pub-5449371042798610"
                     data-ad-slot="9264203071"
                     data-ad-format="auto"
                     data-full-width-responsive="true"></ins>
                <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
            </div>
        </aside>

    </main>

    <sv-footer base-path=".."></sv-footer>

    <script>
        let expenses = JSON.parse(localStorage.getItem('sv_budget_items')) || [
            { id: Date.now(), desc: 'Initial Example', cat: 'Software', cost: 1200 }
        ];

        function save() {
            localStorage.setItem('sv_budget_items', JSON.stringify(expenses));
            localStorage.setItem('sv_budget_limit', document.getElementById('projectLimit').value);
        }

        function addItem() {
            expenses.push({ id: Date.now(), desc: '', cat: 'Other', cost: 0 });
            render();
        }

        function deleteItem(id) {
            expenses = expenses.filter(e => e.id !== id);
            render();
        }

        function updateItem(id, field, value) {
            const item = expenses.find(e => e.id === id);
            if (item) {
                item[field] = field === 'cost' ? parseFloat(value) || 0 : value;
                save();
                updateCalculations();
            }
        }

        function updateCalculations() {
            const limit = parseFloat(document.getElementById('projectLimit').value) || 0;
            const spent = expenses.reduce((sum, e) => sum + e.cost, 0);
            const remaining = limit - spent;

            document.getElementById('totalBudget').innerText = `₹${limit.toLocaleString()}`;
            document.getElementById('totalSpent').innerText = `₹${spent.toLocaleString()}`;
            document.getElementById('remainingBudget').innerText = `₹${remaining.toLocaleString()}`;
            
            // Color feedback
            const remainingEl = document.getElementById('remainingBudget');
            if (remaining < 0) {
                remainingEl.classList.replace('text-emerald-400', 'text-red-500');
            } else {
                remainingEl.classList.replace('text-red-500', 'text-emerald-400');
            }
            save();
        }

        function render() {
            const tbody = document.getElementById('expenseList');
            tbody.innerHTML = '';
            
            expenses.forEach(e => {
                const tr = document.createElement('tr');
                tr.className = "hover:bg-slate-800/30 transition-colors";
                tr.innerHTML = `
                    <td class="px-6 py-4">
                        <input type="text" value="${e.desc}" placeholder="Expense name..." oninput="updateItem(${e.id}, 'desc', this.value)" class="bg-transparent border-none focus:ring-0 text-sm w-full text-slate-300">
                    </td>
                    <td class="px-6 py-4">
                        <select onchange="updateItem(${e.id}, 'cat', this.value)" class="bg-slate-800 text-[10px] uppercase font-bold border-none rounded px-2 py-1 text-slate-400 focus:ring-0">
                            <option value="Software" ${e.cat === 'Software' ? 'selected' : ''}>Software</option>
                            <option value="Labor" ${e.cat === 'Labor' ? 'selected' : ''}>Labor</option>
                            <option value="Marketing" ${e.cat === 'Marketing' ? 'selected' : ''}>Marketing</option>
                            <option value="Other" ${e.cat === 'Other' ? 'selected' : ''}>Other</option>
                        </select>
                    </td>
                    <td class="px-6 py-4 text-right">
                        <input type="number" value="${e.cost}" oninput="updateItem(${e.id}, 'cost', this.value)" class="bg-transparent border-none focus:ring-0 text-sm text-right font-mono w-24 text-white">
                    </td>
                    <td class="px-6 py-4 text-right">
                        <button onclick="deleteItem(${e.id})" class="text-slate-600 hover:text-red-500 transition-colors">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg>
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
            updateCalculations();
        }

        function clearAll() {
            if(confirm("Are you sure? This will delete all saved budget data.")) {
                expenses = [];
                render();
            }
        }

        window.onload = () => {
            const savedLimit = localStorage.getItem('sv_budget_limit');
            if (savedLimit) document.getElementById('projectLimit').value = savedLimit;
            render();
        };
    </script>
</body>
</html>
